<!DOCTYPE html>
<html>
<head>
  <title>Match & Market Simulator with Age Factor</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin-top: 40px;
      background-color: #f2f2f2;
    }
    button {
      padding: 10px 20px;
      margin: 5px;
      font-size: 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      background-color: #007bff;
      color: white;
    }
    button:hover {
      background-color: #0056b3;
    }
    .section {
      margin-top: 30px;
      display: none;
      max-width: 400px;
      margin-left: auto;
      margin-right: auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 8px rgba(0,0,0,0.1);
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }
    input[type=number] {
      padding: 6px;
      width: 100%;
      font-size: 16px;
      margin-top: 5px;
      border-radius: 4px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
  </style>
</head>
<body>

  <h1>Match Simulator - Rating Calculator</h1>

  <button onclick="showSection('match')">Match Simulator</button>
  <button onclick="showSection('market')">Rating Calculator</button>

  <div id="match" class="section">
    <h2>⚽ Match Simulator</h2>
    <label>Team A Rating:</label>
    <input id="ratingA" type="number" value="80" min="0" max="100"><br>

    <label>Team B Rating:</label>
    <input id="ratingB" type="number" value="70" min="0" max="100"><br>

    <label><input type="checkbox" id="homeAdvantage"> Home Advantage</label>
    <button onclick="simulateMatch()">Simulate Match</button>

    <h3 id="result"></h3>
  </div>

  <div id="market" class="section">
    <h2>Market Value - FIFA Rating Calculator</h2>

    <label>Player Market Value (€ Million):</label>
    <input id="marketValue" type="number" value="87" min="0" step="0.01"><br>

    <label>Player Age:</label>
    <input id="playerAge" type="number" value="23" min="10" max="50"><br>

    <button onclick="calculateRating()">Calculate FIFA Rating</button>

    <h3 id="ratingResult"></h3>
  </div>

  <script>
    function showSection(section) {
      document.querySelectorAll('.section').forEach(div => div.style.display = 'none');
      document.getElementById(section).style.display = 'block';
    }

    document.addEventListener('DOMContentLoaded', () => {
      showSection('match');
    });

    function simulateMatch() {
      const ratingA = parseInt(document.getElementById("ratingA").value);
      const ratingB = parseInt(document.getElementById("ratingB").value);
      const homeAdvantageChecked = document.getElementById("homeAdvantage").checked;

      const differenceRaw = Math.abs(ratingA - ratingB);
      const differenceNorm = differenceRaw / 22;
      const totalGoals = 1 + (differenceNorm * 2) * 5;
      const goalDifferenceFactor = Math.max(0.05, 1 - (differenceNorm * 2));

      let teamAStrength = ratingA / (ratingA + ratingB);
      let teamBStrength = ratingB / (ratingA + ratingB);

      if (homeAdvantageChecked) {
        teamAStrength += 0.05;
      }

      const totalStrength = teamAStrength + teamBStrength;
      teamAStrength /= totalStrength;
      teamBStrength /= totalStrength;

      let goalsA = totalGoals * teamAStrength;
      let goalsB = totalGoals * teamBStrength;

      const weaker = ratingA < ratingB ? 'A' : 'B';
      if (weaker === 'A') {
        goalsA *= goalDifferenceFactor;
      } else {
        goalsB *= goalDifferenceFactor;
      }

      goalsA = Math.round(goalsA);
      goalsB = Math.round(goalsB);

      document.getElementById("result").innerText =
        `Score: Team A ${goalsA} - ${goalsB} Team B`;
    }

    function calculateRating() {
      const marketValue = parseFloat(document.getElementById("marketValue").value);
      const age = parseInt(document.getElementById("playerAge").value);

      if (marketValue <= 0) {
        document.getElementById("ratingResult").innerText = "Market value must be greater than 0.";
        return;
      }
      if (age < 10 || age > 50) {
        document.getElementById("ratingResult").innerText = "Age must be between 10 and 50.";
        return;
      }

      let ageFactor;
      if (age <= 18) ageFactor = 2.2;
      else if (age <= 20) ageFactor = 2.0;
      else if (age <= 23) ageFactor = 1.8;
      else if (age <= 26) ageFactor = 1.6;
      else if (age <= 29) ageFactor = 1.3;
      else if (age <= 31) ageFactor = 1.0;
      else if (age <= 34) ageFactor = 0.7;
      else if (age <= 37) ageFactor = 0.4;
      else ageFactor = 0.3;

      const baseFactor = 0.00000711;
      const rating = (1 / 0.1885) * Math.log(marketValue / (baseFactor * ageFactor));
      const finalRating = Math.round(rating);

      document.getElementById("ratingResult").innerText = `Estimated FIFA Rating: ${finalRating}`;
    }
  </script>

</body>
</html>
